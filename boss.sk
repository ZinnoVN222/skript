command /summonboss:
    trigger:
        if name of player's tool is not "&dCh√¨a Kho√° Tri·ªáu H·ªìi":
            send "&c‚ùå B·∫°n c·∫ßn c·∫ßm &dCh√¨a Kho√° Tri·ªáu H·ªìi &cƒë·ªÉ tri·ªáu h·ªìi boss!"
            stop

        remove 1 of player's tool from player
        broadcast "&6‚öî &e%player% &7ƒë√£ tri·ªáu h·ªìi BOSS t·∫°i &c%x-location of player%, %z-location of player%&7!"
        spawn a wither at location of player
        set name of last spawned entity to "&cBOSS ƒê·ªãa Ng·ª•c"
        set metadata "boss" of last spawned entity to true

command /givekey:
    trigger:
        give tripwire hook named "&dCh√¨a Kho√° Tri·ªáu H·ªìi" to player
on damage of a wither:
    attacker is a player
    metadata "boss" of victim is true
    set {_uuid} to uuid of victim
    add damage to {boss::dame::%{_uuid}%::%name of attacker%}

on death of a wither:
    metadata "boss" of victim is true
    clear drops
    set {_boss} to uuid of victim
    broadcast "&e[BOSS DEBUG] Boss ch·∫øt. ƒêang x·ª≠ l√Ω s√°t th∆∞∆°ng..."
    loop {boss::dame::%{_boss}%::*}:
        set {_name} to loop-index
        set {_dame} to loop-value
        broadcast "&7- %{_name}% g√¢y %{_dame}% s√°t th∆∞∆°ng"
        if {_dame} >= 100:
            execute console command "give %{_name}% diamond 1"
            send "&aüéâ B·∫°n ƒë√£ nh·∫≠n ƒë∆∞·ª£c ph·∫ßn th∆∞·ªüng v√¨ g√¢y ƒë·ªß s√°t th∆∞∆°ng v√†o boss!" to {_name}
    delete {boss::dame::%{_boss}%::*}

on place of obsidian:
    if player's tool is set:
        set {_name} to player's tool's display name
        if {_name} is "¬ßcObsidian Tri·ªáu H·ªìi":
            if player is sneaking:
                set {_loc} to event-location
                set {_valid} to true

                set {_x_offsets::*} to -1 and -1 and -1 and 0 and 0 and 1 and 1 and 1
                set {_z_offsets::*} to -1 and 0 and 1 and -1 and 1 and -1 and 0 and 1

                loop 8 times:
                    set {_x} to {_x_offsets::%loop-number%}
                    set {_z} to {_z_offsets::%loop-number%}
                    set {_loc2} to location at (x-coordinate of {_loc} + {_x}), (y-coordinate of {_loc}), (z-coordinate of {_loc} + {_z})
                    if block at {_loc2} is not diamond block:
                        set {_valid} to false
                        stop loop

                if {_valid} is true:
                    # X√≥a v√≤ng kim c∆∞∆°ng
                    loop 8 times:
                        set {_x} to {_x_offsets::%loop-number%}
                        set {_z} to {_z_offsets::%loop-number%}
                        set {_loc2} to location at (x-coordinate of {_loc} + {_x}), (y-coordinate of {_loc}), (z-coordinate of {_loc} + {_z})
                        set block at {_loc2} to air

                    # X√≥a obsidian trung t√¢m
                    set block at {_loc} to air

                    # Tri·ªáu h·ªìi Wither
                    spawn wither at {_loc}

                    send "&aB·∫°n ƒë√£ tri·ªáu h·ªìi Boss Wither!" to player
                    cancel event
                else:
                    send "&cB·∫°n c·∫ßn ƒë·∫∑t Obsidian ·ªü gi·ªØa v√≤ng kim c∆∞∆°ng!" to player
                    cancel event
            else:
                # Kh√¥ng c√∫i ng∆∞·ªùi th√¨ KH√îNG cho ƒë·∫∑t block
                send "&eB·∫°n ph·∫£i c√∫i ng∆∞·ªùi (Shift) ƒë·ªÉ th·ª±c hi·ªán tri·ªáu h·ªìi Wither!" to player
                cancel event


command /giveobsidian:
    trigger:
        set {_item} to obsidian named "¬ßcObsidian Tri·ªáu H·ªìi"
        give {_item} to player
        send "&aB·∫°n ƒë√£ nh·∫≠n ƒë∆∞·ª£c Obsidian Tri·ªáu H·ªìi!" to player

